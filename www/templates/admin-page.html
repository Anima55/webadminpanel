<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

    <header class="top-nav">
        <div class="nav-left">
            <div class="nav-icon"><a href="/" style="color:white; text-decoration:none;">üõ°Ô∏è ForgeRock</a></div> 
            <a href="/logs" class="logs-btn">üìë –ñ—É—Ä–Ω–∞–ª –î—ñ–π</a>
            <form method="POST" action="{{ url_for('backup_route') }}" style="display:inline;">
                <button type="submit" class="backup-btn" 
                        onclick="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–≤–Ω—É —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é –±–∞–∑–∏ –¥–∞–Ω–∏—Ö? –¶–µ –º–æ–∂–µ –∑–∞–π–Ω—è—Ç–∏ –¥–µ—è–∫–∏–π —á–∞—Å.');">
                    üíæ –†–µ–∑–µ—Ä–≤–Ω–∞ –∫–æ–ø—ñ—è –ë–î
                </button>
            </form>
        </div>

        <nav class="nav-right">
            <a href="{{ url_for('home') }}" class="nav-button">HelperInfo</a>
            <a href="{{ url_for('tickets') }}" class="nav-button">TicketInfo</a>
            <a href="{{ url_for('logout') }}" class="nav-button" style="background-color: #dc3545;">–í–∏—Ö—ñ–¥</a>        
        </nav>
    </header>
    <main class="site-body">
        
        <section class="main-block">
            <script src="{{ url_for('script', filename='webadmin.js') }}"></script> 

            <div class="search-bar-container">
                <div class="search-filter-wrapper">
                    <div class="search-input-wrapper">
                        <form method="GET" action="{{ request.path }}" id="filterForm">
                            <input type="text" placeholder="–ü–æ—à—É–∫ (–Ü–º'—è, –†–∞–Ω–≥, ID)..." class="search-input" name="query" value="{{ request.args.get('query', '') }}">
                            <input type="hidden" name="sort_by" id="active_sort_by" value="{{ request.args.get('sort_by', '') }}">
                            <input type="hidden" name="sort_type" id="active_sort_type" value="{{ request.args.get('sort_type', 'asc') }}">
                            <input type="hidden" name="rank_filter" id="active_rank_filter" value="{{ request.args.get('rank_filter', '') }}">
                        </form>
                    </div>
                    <button class="filter-btn" onclick="openFilterModal()">‚öôÔ∏è –§—ñ–ª—å—Ç—Ä</button> 
                    <button class="add-btn" onclick="openAddWebadminModal()">‚ûï –î–æ–¥–∞—Ç–∏ WebAdmin</button>
                </div>
            </div>

            <div id="filterModal" class="modal">
                <div class="modal-content filter-modal-content">
                    <span class="close-btn" onclick="closeFilterModal()">&times;</span>
                    <h2>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä—ñ–≤</h2>
                    
                    <form method="GET" action="{{ request.path }}" id="filterForm">
    
                        <input type="hidden" name="query" value="{{ request.args.get('query', '') }}">
                        <input type="hidden" name="sort_by" id="active_sort_by" value="{{ request.args.get('sort_by', '') }}">
                        <input type="hidden" name="sort_type" id="active_sort_type" value="{{ request.args.get('sort_type', 'asc') }}">
                        <input type="hidden" name="rank_filter" id="active_rank_filter" value="{{ request.args.get('rank_filter', '') }}">

                        <h3>–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è:</h3>

                        {% set current_sort_by = request.args.get('sort_by', '') %}
                        {% set current_sort_type = request.args.get('sort_type', 'asc') %}

                        <div class="filter-option">
                            <label>–Ü–º'—è (–∑–∞ –∞–ª—Ñ–∞–≤—ñ—Ç–æ–º):</label>
                            <div class="sort-control">
                                <button type="button" class="sort-toggle-btn" id="webadmin_name_btn"
                                        data-sort-field="webadmin_name" onclick="applySort('webadmin_name', 'webadmin_name_btn')">
                                    {% if current_sort_by == 'webadmin_name' %}
                                        {{ '‚¨áÔ∏è –°–ø–∞–¥–∞–Ω–Ω—è' if current_sort_type == 'desc' else '‚¨ÜÔ∏è –ó—Ä–æ—Å—Ç–∞–Ω–Ω—è' }}
                                    {% else %}
                                        üîÑ –°–æ—Ä—Ç—É–≤–∞—Ç–∏
                                    {% endif %}
                                </button>
                            </div>
                        </div>
                     
                        <h3 style="margin-top: 20px;">–§—ñ–ª—å—Ç—Ä –∑–∞ —Ä–∞–Ω–≥–æ–º:</h3>

                        {% set current_rank_filter = request.args.get('rank_filter', '') %}
                        
                        <div class="rank-filter-section">
                            <label for="rank_filter_select">–û–±–µ—Ä—ñ—Ç—å —Ä–∞–Ω–≥:</label>
                            <select id="rank_filter_select" class="rank-select">
                                <option value="">–í—Å—ñ —Ä–∞–Ω–≥–∏</option>
                                <option value="Curator" {% if current_rank_filter == 'Curator' %}selected{% endif %}>Curator</option>
                                <option value="Manager" {% if current_rank_filter == 'Manager' %}selected{% endif %}>Manager</option>
                                <option value="SuperAdmin" {% if current_rank_filter == 'SuperAdmin' %}selected{% endif %}>SuperAdmin</option>
                            </select>
                        </div>

                    </form>
                    
                    <div class="modal-buttons" style="margin-top: 30px; justify-content: center;">
                        <button type="button" class="save-btn" onclick="applyAllFilters()">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</button>
                        <button type="button" class="delete-btn" onclick="resetSortFilters()">–°–∫–∏–Ω—É—Ç–∏ –≤—Å—ñ —Ñ—ñ–ª—å—Ç—Ä–∏</button>
                    </div>

                </div>
            </div>
            
            <div class="table-container">
                <div class="main-block">
                    <div class="content-header">
                        <div>
                            <h2>{{ main_content_title }}</h2>
                            <p class="item-count-text">–ö—ñ–ª—å–∫—ñ—Å—Ç—å: {{ webadmin_list|length }}</p>
                        </div>
                    </div>
                
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID WebAdmin</th>
                                <th>–Ü–º'—è</th>
                                <th>–†–∞–Ω–≥</th>
                                <th>–î—ñ—ó</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for admin in webadmin_list %}
                            <tr data-id="{{ admin.webadmin_id }}" data-name="{{ admin.webadmin_name }}" data-rank="{{ admin.webadmin_rank }}">
                                <td>{{ admin.webadmin_id }}</td>
                                <td>{{ admin.webadmin_name }}</td>
                                <td>{{ admin.webadmin_rank }}</td>
                                <td>
                                    <button class="edit-btn" onclick="openEditWebadminModal(this)">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                                </td>
                            </tr>
                            {% endfor %}
                            {% if not webadmin_list %}
                            <tr>
                                <td colspan="4" style="text-align: center;">–í–µ–±-–∞–¥–º—ñ–Ω–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</td>
                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è WebAdmin -->
            <div id="addWebadminModal" class="modal">
                <div class="modal-content">
                    <span class="close-btn" onclick="closeAddWebadminModal()">&times;</span>
                    <h2>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ WebAdmin</h2>
                    
                    <form method="POST" action="{{ url_for('add_webadmin') }}" id="addForm">
                        
                        <label for="add_webadmin_name">–Ü–º'—è:</label>
                        <input type="text" id="add_webadmin_name" name="webadmin_name" required>
                        
                        <label for="add_webadmin_rank">–†–∞–Ω–≥:</label>
                        <select id="add_webadmin_rank" name="webadmin_rank" required>
                            <option value="Curator">Curator</option>
                            <option value="Manager">Manager</option>
                            <option value="SuperAdmin">SuperAdmin</option>
                        </select>

                        <label for="add_webadmin_password">–ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="add_webadmin_password" name="webadmin_password" required>
                        
                        <div class="modal-buttons" style="margin-top: 20px; justify-content: center;">
                            <button type="submit" class="save-btn">–î–æ–¥–∞—Ç–∏ WebAdmin</button>
                        </div>
                    </form>
                </div>
            </div>
            
           <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è WebAdmin -->
<div id="editWebadminModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeEditWebadminModal()">&times;</span>
        <h2>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ WebAdmin</h2>
        
        <!-- –Ñ–î–ò–ù–ê —Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è -->
        <form method="POST" action="{{ url_for('update_webadmin') }}" id="editForm">
            <input type="hidden" name="webadmin_id" id="modal_webadmin_id">
            
            <label for="modal_webadmin_name">–Ü–º'—è:</label>
            <input type="text" id="modal_webadmin_name" name="username" required>
            
            <label for="modal_webadmin_rank">–†–∞–Ω–≥:</label>
            <select id="modal_webadmin_rank" name="webadmin_rank" required>
                <option value="Curator">Curator</option>
                <option value="Manager">Manager</option>
                <option value="SuperAdmin">SuperAdmin</option>
            </select>
            
            <label for="modal_webadmin_password">–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å (–∑–∞–ª–∏—à—ñ—Ç—å –ø–æ—Ä–æ–∂–Ω—ñ–º, —â–æ–± –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏):</label>
            <input type="password" id="modal_webadmin_password" name="password">
            
            <div class="modal-buttons">
                <div class="modal-buttons-left">
                    <button type="submit" class="save-btn">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤ —Ç—ñ–π –∂–µ —Ñ–æ—Ä–º—ñ, –∞–ª–µ –∑ —ñ–Ω—à–∏–º —Ç–∏–ø–æ–º -->
                <button type="button" class="delete-btn" onclick="deleteWebadmin()">
                    –í–∏–¥–∞–ª–∏—Ç–∏
                </button>
            </div>
        </form>
    </div>
</div>
        </section>
    </main>

</body>
</html>